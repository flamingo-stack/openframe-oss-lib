<!-- source-hash: 630bcde6294a43fb3796f95fd16fc301 -->
This Spring WebFlux security configuration class defines authentication and authorization rules for a reactive gateway application, setting up JWT-based OAuth2 resource server security with role-based access control.

## Key Components

- **`reactiveJwtAuthenticationConverter()`** - Configures JWT token conversion to extract roles and scopes with proper prefixes
- **`springSecurityFilterChain()`** - Main security filter chain defining path-based authorization rules and OAuth2 resource server configuration
- **`passwordEncoder()`** - BCrypt password encoder bean for password hashing
- **Role-based access control** - Supports ADMIN and AGENT roles with different permission levels
- **Custom filter integration** - Adds `AddAuthorizationHeaderFilter` before authentication

## Usage Example

```java
// The configuration automatically applies these security rules:

// Public endpoints (no authentication required)
GET /health/status                    // ✅ Permitted
POST /clients/api/agents/register     // ✅ Permitted
GET /actuator/health                  // ✅ Permitted

// Admin-only endpoints
GET /dashboard/users                  // ❌ Requires ROLE_ADMIN
POST /tools/deploy                    // ❌ Requires ROLE_ADMIN

// Agent-only endpoints  
GET /tools/agent/status               // ❌ Requires ROLE_AGENT
POST /clients/api/data                // ❌ Requires ROLE_AGENT

// WebSocket NATS endpoint
WS /nats/websocket                    // ❌ Requires ROLE_AGENT or ROLE_ADMIN
```

The configuration disables CSRF, CORS, HTTP Basic, and form login while enabling OAuth2 JWT resource server authentication with custom authority resolution.