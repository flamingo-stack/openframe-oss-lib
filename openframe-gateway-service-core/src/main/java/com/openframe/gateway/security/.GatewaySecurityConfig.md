<!-- source-hash: 5f24f1bef300427aa85a4abe4e9c03b1 -->
A Spring Security configuration class that sets up reactive security for the OpenFrame gateway service, implementing JWT-based authentication and role-based authorization for different API endpoints.

## Key Components

**Authentication Configuration:**
- `reactiveJwtAuthenticationConverter()` - Configures JWT token processing with dual authority extraction from both `roles` and `scope` claims
- Role-based authorities with `ROLE_` prefix and scope-based authorities with `SCOPE_` prefix
- Principal claim mapping using the `sub` (subject) field

**Security Filter Chain:**
- `springSecurityFilterChain()` - Main security configuration defining endpoint access rules
- Disables CSRF, CORS, HTTP Basic, and Form Login for stateless API operation
- Implements OAuth2 resource server with JWT authentication
- Custom authorization header filter integration

**Access Control Rules:**
- **Public Access**: OPTIONS requests, agent registration, OAuth token endpoints, metrics
- **ADMIN Role**: Full API access (`/api/**`), admin tools (`/tools/**`, `/ws-tools/**`)
- **AGENT Role**: Agent-specific endpoints, client services, NATS WebSocket connections
- **Shared Access**: Chat endpoints accessible to both ADMIN and AGENT roles

## Usage Example

```java
@RestController
@RequestMapping("/api/users")
@PreAuthorize("hasRole('ADMIN')")
public class UserController {
    
    @GetMapping
    public Flux<User> getUsers(Authentication auth) {
        // Accessible only to ADMIN role
        log.info("Admin {} accessing users", auth.getName());
        return userService.findAll();
    }
}

@RestController
@RequestMapping("/tools/agent")
@PreAuthorize("hasRole('AGENT')")
public class AgentToolsController {
    
    @PostMapping("/execute")
    public Mono<ToolResult> executeTool(@RequestBody ToolRequest request) {
        // Accessible only to AGENT role
        return toolService.execute(request);
    }
}
```

The configuration supports OpenFrame's multi-tenant architecture where agents and administrators have distinct access levels to different service endpoints.