<!-- source-hash: 630bcde6294a43fb3796f95fd16fc301 -->
This Spring Security configuration class sets up reactive security for the OpenFrame API Gateway, handling JWT-based authentication and role-based authorization for different service endpoints.

## Key Components

- **`ReactiveJwtAuthenticationConverter`** - Configures JWT token parsing to extract roles and scopes from claims, setting appropriate prefixes for Spring Security authorities
- **`SecurityWebFilterChain`** - Defines the main security filter chain with OAuth2 resource server configuration, path-based authorization rules, and custom filters
- **`AddAuthorizationHeaderFilter`** - Custom filter added before authentication to process authorization headers
- **`PasswordEncoder`** - BCrypt password encoder bean for secure password handling

## Usage Example

```java
// The security configuration automatically applies to all requests
// Role-based access is enforced based on JWT claims:

// ADMIN role can access:
// - /dashboard/** endpoints
// - /tools/** endpoints (API tools)
// - WebSocket NATS endpoint

// AGENT role can access:
// - /tools/agent/** endpoints
// - /ws-tools/agent/** endpoints  
// - /clients/** endpoints
// - WebSocket NATS endpoint

// Public access (no authentication required):
// - OPTIONS requests
// - Health and metrics endpoints
// - Agent registration
// - OAuth token endpoint
// - Actuator endpoints
// - UI routes (/**)
```

The configuration uses Spring WebFlux reactive security with JWT authentication, supporting multiple issuers through the authentication manager resolver and providing granular path-based authorization for different user roles.