<!-- source-hash: e9c2352f7dbb82fce75e16b4c3dcbdb2 -->
A Spring WebFlux filter that ensures the Authorization header is present by resolving bearer tokens from multiple sources (cookies, custom headers, query parameters) and adding them to requests for protected endpoints.

## Key Components

- **`AddAuthorizationHeaderFilter`** - Main filter class implementing `WebFilter` interface
- **`isPrivatePath(String path)`** - Determines if a request path requires authentication
- **`resolveBearerToken(ServerWebExchange exchange)`** - Resolves tokens from multiple sources in priority order
- **`CookieService cookieService`** - Injected service for extracting tokens from cookies

## Usage Example

This filter automatically processes incoming requests and adds Authorization headers when needed:

```java
@Configuration
public class SecurityConfig {
    
    @Bean
    public SecurityWebFilterChain filterChain(
        ServerHttpSecurity http,
        AddAuthorizationHeaderFilter authFilter
    ) {
        return http
            .addFilterBefore(authFilter, AuthenticationWebFilter.class)
            .authorizeExchange(exchanges -> 
                exchanges
                    .pathMatchers("/api/**").authenticated()
                    .anyExchange().permitAll()
            )
            .build();
    }
}
```

The filter supports token resolution from:
1. `access_token` cookie (highest priority)
2. Custom `Access-Token` header  
3. `authorization` query parameter (lowest priority)

Protected paths include `/api/`, `/tools/`, `/ws-tools/`, `/chat/`, and client-specific endpoints while excluding public paths like metrics and registration endpoints.