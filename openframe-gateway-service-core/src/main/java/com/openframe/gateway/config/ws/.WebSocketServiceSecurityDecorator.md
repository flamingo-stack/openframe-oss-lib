<!-- source-hash: a91c08bb2b49a3caaaaf10bbe224c733 -->
A security decorator for WebSocket services that automatically closes WebSocket sessions when JWT tokens expire, preventing unauthorized access after token expiration.

## Key Components

- **WebSocketServiceSecurityDecorator**: Main decorator class implementing `WebSocketService`
- **handleRequest()**: Intercepts WebSocket requests and applies security logic for secured endpoints
- **scheduleSessionRemoveJob()**: Creates a delayed task to close sessions when JWT expires
- **processSessionClosedEvent()**: Handles cleanup when sessions are manually closed
- **isSecuredEndpoint()**: Determines if an endpoint requires JWT-based session management

## Usage Example

```java
@Configuration
public class WebSocketConfig {
    
    @Bean
    public WebSocketService webSocketService(
            WebSocketService defaultService,
            RequestJwt–°laimsReader jwtReader) {
        return new WebSocketServiceSecurityDecorator(defaultService, jwtReader);
    }
}

// The decorator automatically handles secured endpoints:
// - Reads JWT expiration from request
// - Schedules session termination before token expires
// - Accounts for 60-second clock skew
// - Cleans up scheduled jobs if session closes early
```

The decorator ensures WebSocket connections are automatically terminated when the associated JWT token expires, maintaining security boundaries in real-time applications. It includes clock skew tolerance and proper cleanup mechanisms for optimal resource management.