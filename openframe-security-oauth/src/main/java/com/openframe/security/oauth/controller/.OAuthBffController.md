<!-- source-hash: 488c9eee72cae3f2014583525dfa46fa -->
REST controller that implements OAuth 2.0 Backend-for-Frontend (BFF) authentication flows with PKCE support, cookie management, and development features.

## Key Components

**Main Endpoints:**
- `login()` - Initiates OAuth flow with state/PKCE and clears existing cookies
- `continueFlow()` - Continues OAuth without clearing authentication (for SSO scenarios)
- `callback()` - Handles OAuth provider callback and token exchange
- `refresh()` - Refreshes access tokens using refresh token
- `logout()` - Revokes tokens and clears authentication cookies
- `devExchange()` - Development-only endpoint for token exchange via tickets

**Dependencies:**
- `OAuthBffService` - Core OAuth business logic
- `OAuthDevTicketStore` - Development ticket management
- `CookieService` - HTTP cookie operations

## Usage Example

```java
// OAuth login initiation
@GetMapping("/login")
public Mono<ResponseEntity<Void>> login(
    @RequestParam String tenantId,
    @RequestParam(required = false) String redirectTo,
    @RequestParam(required = false) String provider,
    ServerHttpRequest request) {
    
    // Clears existing cookies and redirects to OAuth provider
    return oauthBffService.buildAuthorizeRedirect(tenantId, redirectTo, provider, request)
        .map(data -> {
            String stateJwt = oauthBffService.buildStateJwt(data, stateCookieTtlSeconds);
            // Sets state cookie and redirects to authorization URL
            return ResponseEntity.status(FOUND)
                .header(LOCATION, data.authorizeUrl())
                .build();
        });
}

// Token refresh
@PostMapping("/refresh") 
public Mono<ResponseEntity<Void>> refresh(
    @RequestParam String tenantId,
    @CookieValue(required = false) String refreshCookie,
    ServerHttpRequest request) {
    
    return oauthBffService.refreshTokensPublic(tenantId, token, request)
        .map(tokens -> buildNoContentWithCookies(tokens, devTicketEnabled));
}
```

The controller is conditionally enabled via `openframe.gateway.oauth.enable=true` and supports both production cookie-based authentication and development header-based token exchange.