<!-- source-hash: 08de9b532f4c879868f5b78310637a7a -->
A Spring service that provides comprehensive log querying, filtering, and detailed retrieval functionality for the OpenFrame audit system, utilizing both Apache Pinot for fast analytics queries and Cassandra for detailed log storage.

## Key Components

- **queryLogs()** - Main method for paginated log queries with filtering, search, and sorting capabilities
- **findLogDetails()** - Retrieves complete log details from Cassandra using composite key lookup
- **getLogFilters()** - Provides available filter options (tool types, event types, severities, organizations) based on current data
- **buildLogQueryResult()** - Constructs paginated query results with cursor-based navigation
- **mapToLogEvent()** / **mapToLogDetails()** - Data transformation methods for different view models
- **validateSortField()** - Ensures only valid sortable fields are used in queries

The service integrates two data sources: PinotLogRepository for high-performance analytical queries and UnifiedLogEventRepository for detailed log storage in Cassandra.

## Usage Example

```java
@RestController
public class LogController {
    
    @Autowired
    private LogService logService;
    
    @GetMapping("/api/logs")
    public GenericQueryResult<LogEvent> getLogs(
            @RequestParam LocalDate startDate,
            @RequestParam LocalDate endDate,
            @RequestParam(required = false) String search) {
        
        LogFilterOptions filters = LogFilterOptions.builder()
            .startDate(startDate)
            .endDate(endDate)
            .build();
            
        CursorPaginationCriteria pagination = new CursorPaginationCriteria(null, 50);
        SortInput sort = new SortInput("timestamp", SortDirection.DESC);
        
        return logService.queryLogs(filters, pagination, search, sort);
    }
    
    @GetMapping("/api/logs/{toolEventId}/details")
    public ResponseEntity<LogDetails> getLogDetails(
            @PathVariable String toolEventId,
            @RequestParam String ingestDay,
            @RequestParam String toolType,
            @RequestParam String eventType,
            @RequestParam Instant timestamp) {
        
        return logService.findLogDetails(ingestDay, toolType, eventType, timestamp, toolEventId)
            .map(ResponseEntity::ok)
            .orElse(ResponseEntity.notFound().build());
    }
}
```