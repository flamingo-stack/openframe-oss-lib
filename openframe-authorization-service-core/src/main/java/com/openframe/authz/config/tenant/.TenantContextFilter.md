<!-- source-hash: 92340d4f15a6d3467ce4d3ae51db5ac9 -->
A servlet filter that extracts tenant information from HTTP requests and establishes tenant context for multi-tenant authentication flows. It parses tenant IDs from URL paths, query parameters, or session data while handling session invalidation when tenants change.

## Key Components

- **TenantContextFilter** - Main filter class extending `OncePerRequestFilter`
- **TENANT_ID** - Session attribute constant for storing tenant identifier
- **EXCLUDED_CONTEXTS** - Set of path segments that bypass tenant extraction
- **doFilterInternal()** - Core filtering logic for tenant context establishment
- **getString()** - Utility method for extracting application path from request URI

## Usage Example

```java
// The filter automatically processes requests based on URL patterns:
// /tenant1/oauth2/authorize -> sets tenant to "tenant1"
// /tenant2/login -> sets tenant to "tenant2"
// /public/api -> no tenant context (excluded)

// Accessing tenant context in downstream components:
@RestController
public class ApiController {
    
    @GetMapping("/api/data")
    public ResponseEntity<String> getData() {
        String tenantId = TenantContext.getTenantId();
        // Use tenantId for tenant-specific operations
        return ResponseEntity.ok("Data for tenant: " + tenantId);
    }
}

// Manual session access:
HttpSession session = request.getSession();
String tenantId = (String) session.getAttribute(TenantContextFilter.TENANT_ID);
```

The filter runs with high precedence (`HIGHEST_PRECEDENCE + 10`) and automatically clears tenant context after request processing to prevent context leakage between requests.