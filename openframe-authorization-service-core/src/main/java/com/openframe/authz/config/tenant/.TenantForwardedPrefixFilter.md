<!-- source-hash: 0603f841f1d1aa6549c2cc357c3bbb40 -->
A servlet filter that ensures Spring Authorization Server computes multi-tenant issuer URLs correctly by adding the tenant ID to the X-Forwarded-Prefix header when processing OAuth2/OIDC endpoints.

## Key Components

- **TenantForwardedPrefixFilter**: Main filter class extending `OncePerRequestFilter`
- **AddHeaderRequestWrapper**: Internal wrapper class that adds the X-Forwarded-Prefix header
- **doFilterInternal()**: Core logic that conditionally adds tenant prefix to OAuth2/OIDC endpoints
- **X_FORWARDED_PREFIX**: Static constant for the forwarded prefix header name

## Usage Example

Configure the filter in your Spring Security chain after `TenantContextFilter` and before `ForwardedHeaderFilter`:

```java
@Bean
public FilterRegistrationBean<TenantForwardedPrefixFilter> tenantForwardedPrefixFilter() {
    FilterRegistrationBean<TenantForwardedPrefixFilter> registration = 
        new FilterRegistrationBean<>();
    registration.setFilter(new TenantForwardedPrefixFilter());
    registration.setOrder(2); // After TenantContextFilter, before ForwardedHeaderFilter
    return registration;
}
```

The filter automatically processes requests to OAuth2 endpoints (`/.well-known/`, `/oauth2/`, `/connect/`, `/userinfo`) and adds the tenant ID as a prefix. For example, when `TenantContext.getTenantId()` returns "tenant1", the filter adds `X-Forwarded-Prefix: /tenant1` to ensure the authorization server generates issuer URLs like `https://host/tenant1`.