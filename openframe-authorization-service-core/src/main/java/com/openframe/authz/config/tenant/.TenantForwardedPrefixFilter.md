<!-- source-hash: 0603f841f1d1aa6549c2cc357c3bbb40 -->
A Spring filter that automatically injects tenant information into the `X-Forwarded-Prefix` header for Spring Authorization Server endpoints, ensuring proper issuer URL computation in multi-tenant environments.

## Key Components

- **TenantForwardedPrefixFilter** - Main filter class extending `OncePerRequestFilter`
- **AddHeaderRequestWrapper** - Inner wrapper class for adding headers to HTTP requests
- **doFilterInternal()** - Core filtering logic that conditionally adds tenant prefix
- **Tenant detection logic** - Identifies Spring Authorization Server endpoints and applies tenant prefixing

## Usage Example

```java
// Register the filter in your security configuration
@Configuration
public class SecurityConfig {
    
    @Bean
    public FilterRegistrationBean<TenantForwardedPrefixFilter> tenantForwardedPrefixFilter() {
        FilterRegistrationBean<TenantForwardedPrefixFilter> registration = 
            new FilterRegistrationBean<>();
        registration.setFilter(new TenantForwardedPrefixFilter());
        registration.setOrder(2); // After TenantContextFilter, before ForwardedHeaderFilter
        return registration;
    }
}

// The filter automatically processes requests like:
// /oauth2/token -> adds X-Forwarded-Prefix: /tenant123
// /.well-known/openid-configuration -> adds X-Forwarded-Prefix: /tenant123
// /userinfo -> adds X-Forwarded-Prefix: /tenant123
```

The filter ensures that Spring Authorization Server generates correct issuer URLs (`https://host/{tenant}`) by automatically injecting the current tenant ID as a forwarded prefix header, but only for authorization server endpoints and when no existing prefix is present.