<!-- source-hash: 30ba0720c3f8b7af040edcb04373ef74 -->
This configuration class sets up a multi-tenant OAuth2 Authorization Server with JWT token support, custom authentication, and tenant-aware key management.

## Key Components

- **Security Filter Chain** - Configures OAuth2 authorization server endpoints with OIDC support and multi-issuer capability
- **JWT Components** - `JWKSource`, `JwtDecoder`, and `JwtEncoder` beans for tenant-specific RSA key management
- **Token Customizer** - Adds custom claims (tenant_id, userId, roles) to JWT access tokens with role inheritance
- **User Authentication** - `UserDetailsService` and `AuthenticationManager` for database-backed user authentication
- **Filter Registration** - Tenant-aware forwarded header processing and prefix filtering
- **Password Security** - BCrypt password encoder for secure password hashing

## Usage Example

```java
@Autowired
private AuthenticationManager authenticationManager;

@Autowired
private UserDetailsService userDetailsService;

// Programmatic authentication
public Authentication authenticateUser(String username, String password) {
    UsernamePasswordAuthenticationToken token = 
        new UsernamePasswordAuthenticationToken(username, password);
    return authenticationManager.authenticate(token);
}

// Load user details for security context
public UserDetails loadUser(String email) {
    return userDetailsService.loadUserByUsername(email);
}

// The JWT tokens will automatically include:
// - tenant_id: Current tenant identifier
// - userId: User's database ID
// - roles: User roles with OWNER->ADMIN inheritance
```

The configuration supports tenant isolation through context-aware key selection and claims customization, enabling secure multi-tenant OAuth2 flows.