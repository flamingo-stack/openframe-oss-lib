<!-- source-hash: 3ff3db9db0a6095337464291f3631ae0 -->
A Spring service that manages RSA key pairs for tenant-specific JWT signing operations, providing automatic key generation and secure storage with encryption.

## Key Components

- **getOrCreateActiveKey(String tenantId)** - Retrieves existing active RSA key or generates new one for tenant
- **createAndStore(String tenantId)** - Creates new RSA key pair, encrypts private key, and persists to database
- **TenantKeyRepository** - Data access layer for tenant key persistence
- **EncryptionService** - Handles encryption/decryption of private keys
- **AuthenticationKeyPairGenerator** - Generates RSA key pairs for authentication

## Usage Example

```java
@Service
public class JwtTokenService {
    
    private final TenantKeyService tenantKeyService;
    
    public String signToken(String tenantId, JWTClaimsSet claims) {
        // Get or create active RSA key for tenant
        RSAKey rsaKey = tenantKeyService.getOrCreateActiveKey(tenantId);
        
        // Use key for JWT signing
        JWSSigner signer = new RSASSASigner(rsaKey);
        SignedJWT signedJWT = new SignedJWT(
            new JWSHeader.Builder(JWSAlgorithm.RS256)
                .keyID(rsaKey.getKeyID())
                .build(),
            claims
        );
        signedJWT.sign(signer);
        
        return signedJWT.serialize();
    }
}
```

The service automatically handles key rotation scenarios and warns about multiple active keys that could cause key ID mismatches during JWT verification.