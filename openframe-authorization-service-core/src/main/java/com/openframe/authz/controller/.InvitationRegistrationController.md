<!-- source-hash: 326318efa54d2bf784aae67e7a904b90 -->
REST controller that handles user invitation acceptance and registration workflows, supporting both standard registration and SSO-based invitation flows.

## Key Components

### Endpoints
- **`POST /invitations/accept`** - Accepts JSON registration requests for invited users
- **`GET /invitations/accept/sso`** - Initiates SSO-based invitation acceptance flow

### Services
- **`InvitationRegistrationService`** - Handles standard invitation registration
- **`SsoInvitationService`** - Manages SSO invitation workflows

### DTOs
- **`InvitationRegistrationRequest`** - Standard registration payload
- **`SsoInvitationAcceptRequest`** - SSO invitation acceptance parameters

## Usage Example

```java
// Standard invitation acceptance (JSON POST)
@PostMapping("/invitations/accept")
public AuthUser register(@Valid @RequestBody InvitationRegistrationRequest request) {
    return invitationRegistrationService.registerByInvitation(request);
}

// SSO invitation acceptance (GET with redirect)
@GetMapping("/invitations/accept/sso")
public void acceptViaSso(@Valid @ModelAttribute SsoInvitationAcceptRequest request,
                         HttpServletRequest httpRequest,
                         HttpServletResponse httpResponse) throws Exception {
    // Clear existing auth state
    clearAuthState(httpRequest, httpResponse);
    
    // Initialize SSO flow and set secure cookie
    SsoTenantRegistrationService.SsoAuthorizeData init = ssoInvitationService.startAccept(request);
    Cookie cookie = new Cookie(SsoRegistrationConstants.COOKIE_SSO_INVITE, init.cookieValue());
    cookie.setHttpOnly(true);
    cookie.setSecure(true);
    httpResponse.addCookie(cookie);
    
    // Redirect to SSO provider
    seeOther(httpResponse, init.redirectPath());
}
```

The controller supports dual registration paths: direct JSON-based registration returning an `AuthUser`, and SSO-initiated flows that set secure cookies and redirect to external identity providers.