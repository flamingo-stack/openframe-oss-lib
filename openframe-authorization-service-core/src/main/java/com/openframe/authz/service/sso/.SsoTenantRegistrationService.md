<!-- source-hash: 069da2309c70631e0ede2042da51e059 -->
Manages the SSO tenant registration flow by validating requests, generating secure state cookies, and orchestrating the OAuth2 authorization process. This service handles the initial phase of tenant onboarding through SSO providers.

## Key Components

- **startRegistration()** - Main entry point that validates requests and initiates SSO registration flow
- **SsoAuthorizeData** - Record containing cookie data, provider info, and redirect path for OAuth2 flow
- **normalizeAndEnsureOnboarding()** - Validates and normalizes SSO provider configuration
- **preProcessRegistration()** - Early validation of registration data before redirecting to SSO provider
- **buildCookiePayload()** - Creates secure JWT cookie payload with registration state and expiration

## Usage Example

```java
@Autowired
private SsoTenantRegistrationService ssoService;

// Initialize SSO tenant registration
SsoTenantRegistrationInitRequest request = SsoTenantRegistrationInitRequest.builder()
    .provider("google")
    .tenantName("Acme Corp")
    .tenantDomain("acme")
    .email("admin@acme.com")
    .accessCode("INVITE123")
    .redirectTo("/dashboard")
    .build();

// Start registration flow
SsoAuthorizeData authData = ssoService.startRegistration(request);

// Use returned data to set secure cookie and redirect
response.addCookie(createSecureCookie(authData.cookieValue(), authData.cookieTtlSeconds()));
response.sendRedirect(authData.redirectPath());
```

The service ensures domain availability, validates access codes, and creates a secure state cookie (10-minute TTL) before redirecting users to their SSO provider for authentication.