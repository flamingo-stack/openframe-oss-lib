<!-- source-hash: 069da2309c70631e0ede2042da51e059 -->
A service that initiates SSO-based tenant registration by validating requests, generating secure cookies, and preparing OAuth2 redirects.

## Key Components

- **`startRegistration(SsoTenantRegistrationInitRequest)`** - Main method that orchestrates the registration initialization process
- **`SsoAuthorizeData`** - Record containing cookie data, provider info, and OAuth2 redirect path
- **Validation methods** - `normalizeAndEnsureOnboarding()`, `ensureDomainAvailable()`, `preProcessRegistration()`
- **Cookie management** - Creates JWT cookies with 10-minute TTL for maintaining registration state
- **OAuth2 integration** - Builds provider-specific redirect paths for authentication

## Usage Example

```java
@Autowired
private SsoTenantRegistrationService registrationService;

public ResponseEntity<Void> initiateSsoRegistration(SsoTenantRegistrationInitRequest request) {
    SsoAuthorizeData authData = registrationService.startRegistration(request);
    
    // Set secure cookie
    ResponseCookie cookie = ResponseCookie.from("sso-reg")
        .value(authData.cookieValue())
        .maxAge(authData.cookieTtlSeconds())
        .httpOnly(true)
        .secure(true)
        .build();
    
    // Redirect to SSO provider
    return ResponseEntity.status(HttpStatus.FOUND)
        .header(HttpHeaders.SET_COOKIE, cookie.toString())
        .header(HttpHeaders.LOCATION, authData.redirectPath())
        .build();
}
```