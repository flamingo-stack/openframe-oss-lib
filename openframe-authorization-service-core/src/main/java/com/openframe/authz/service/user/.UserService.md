<!-- source-hash: b68082dfd80b1b5b637a0272d5345a08 -->
A comprehensive service for managing user authentication and registration within OpenFrame's authorization server, handling both local credentials and SSO provider integration with multi-tenant support.

## Key Components

- **User Lookup**: `findActiveByEmail()`, `findActiveByEmailAndTenant()`, `existsByEmailAndTenant()`
- **User Registration**: `registerUser()`, `registerUserFromInvitation()`, `registerOrReactivateFromSso()`
- **Account Management**: `deactivateUser()`, `reactivateUser()`, `updatePassword()`
- **Email Verification**: `markEmailVerified()` with post-processing
- **Session Tracking**: `touchLastLogin()` for authentication timestamps
- **Password Security**: Automatic bcrypt encoding via `PasswordEncoder`
- **Multi-tenant Support**: All operations scoped by tenant ID

## Usage Example

```java
@Autowired
private UserService userService;

// Register new user with local credentials
List<UserRole> roles = List.of(UserRole.USER);
AuthUser user = userService.registerUser(
    "tenant-123", 
    "user@example.com", 
    "John", 
    "Doe", 
    "password123", 
    roles
);

// Register user from invitation (pre-verified email)
AuthUser invitedUser = userService.registerUserFromInvitation(
    "tenant-123", 
    "invited@example.com", 
    "Jane", 
    "Smith", 
    "newpassword", 
    roles
);

// Handle SSO authentication
AuthUser ssoUser = userService.registerOrReactivateFromSso(
    "tenant-123",
    "google-user@example.com",
    "Bob",
    "Wilson", 
    roles,
    "google"
);

// Update login tracking
userService.touchLastLogin("user@example.com", "tenant-123");

// Mark email as verified
userService.markEmailVerified(user.getId());
```