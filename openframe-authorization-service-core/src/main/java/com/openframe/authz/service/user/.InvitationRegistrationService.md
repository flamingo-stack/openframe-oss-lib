<!-- source-hash: c761eaafb86e0c401d9fa9ac8673624c -->
Service that handles user registration through invitation links, managing tenant switching and existing user validation. It processes invitation-based user registration with support for cross-tenant scenarios and user deactivation workflows.

## Key Components

- **registerByInvitation()** - Main registration method that validates invitations and creates/updates users
- **resolveTargetTenantId()** - Determines target tenant ID based on local tenant configuration
- **handleExistingActiveUser()** - Manages scenarios where user already exists in same or different tenant
- **createUserForInvitation()** - Creates new user with invitation details and assigned roles
- **acceptInvitation()** - Updates invitation status and triggers post-processing workflows

## Usage Example

```java
@Autowired
private InvitationRegistrationService invitationService;

// Register user from invitation
InvitationRegistrationRequest request = InvitationRegistrationRequest.builder()
    .invitationId("inv-123")
    .firstName("John")
    .lastName("Doe")
    .password("securePassword")
    .switchTenant(true) // Allow switching from another tenant
    .build();

AuthUser user = invitationService.registerByInvitation(request);
```

The service handles complex tenant management scenarios, including deactivating users from other tenants when `switchTenant` is enabled, and validates invitation status before proceeding with registration.