<!-- source-hash: c761eaafb86e0c401d9fa9ac8673624c -->
Handles user registration through invitation system, managing tenant switching and existing user scenarios.

## Key Components

- **`registerByInvitation()`** - Main method that processes invitation-based user registration
- **`resolveTargetTenantId()`** - Determines target tenant ID based on local tenant configuration
- **`handleExistingActiveUser()`** - Manages scenarios where user already exists in system
- **`createUserForInvitation()`** - Creates new user account from invitation details
- **`acceptInvitation()`** - Marks invitation as accepted and triggers post-processing

## Usage Example

```java
@Autowired
private InvitationRegistrationService invitationService;

public void processUserInvitation() {
    InvitationRegistrationRequest request = InvitationRegistrationRequest.builder()
        .invitationId("inv-123")
        .firstName("John")
        .lastName("Doe")
        .password("securePassword")
        .switchTenant(true)
        .build();
    
    try {
        AuthUser user = invitationService.registerByInvitation(request);
        log.info("User registered successfully: {}", user.getEmail());
    } catch (UserActiveInAnotherTenantException e) {
        log.error("User already active in different tenant");
    }
}
```

The service supports tenant switching when `switchTenant=true`, automatically deactivating users from previous tenants before registration.