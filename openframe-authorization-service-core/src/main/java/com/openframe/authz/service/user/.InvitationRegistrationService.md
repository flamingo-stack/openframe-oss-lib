<!-- source-hash: 78956d4215554e13d41b1450fa20da10 -->
Service that handles user registration through invitation links in the OpenFrame multi-tenant authentication system. It manages tenant switching, user deactivation, and invitation acceptance workflows.

## Key Components

- **registerByInvitation()** - Main entry point that processes invitation registration requests
- **handleExistingActiveUser()** - Manages scenarios where user already exists in same or different tenant
- **createUserForInvitation()** - Creates new user account from invitation details
- **acceptInvitation()** - Marks invitation as accepted and triggers post-processing
- **resolveTargetTenantId()** - Determines target tenant based on local tenant configuration

## Usage Example

```java
@Autowired
private InvitationRegistrationService registrationService;

public void processUserInvitation() {
    InvitationRegistrationRequest request = InvitationRegistrationRequest.builder()
        .invitationId("inv-123")
        .firstName("John")
        .lastName("Doe")
        .password("securePassword123")
        .switchTenant(true) // Allow switching from current tenant
        .build();
    
    try {
        AuthUser newUser = registrationService.registerByInvitation(request);
        log.info("User registered successfully: {}", newUser.getEmail());
    } catch (UserActiveInAnotherTenantException e) {
        log.error("User already active in different tenant: {}", e.getMessage());
    }
}
```

The service supports tenant switching scenarios - if a user is already active in another tenant and `switchTenant=true`, it deactivates the existing user account before creating a new one in the target tenant. For local tenant deployments, it automatically resolves to the first available tenant.