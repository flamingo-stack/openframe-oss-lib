<!-- source-hash: 1d303b1cfb1b2bf6ce40ab7009eec6b6 -->
This utility class provides bidirectional mapping between Spring Security's OAuth2Authorization domain objects and MongoDB entity representations, with special handling for PKCE (Proof Key for Code Exchange) parameters.

## Key Components

- **`toEntity(OAuth2Authorization)`** - Converts Spring Security OAuth2Authorization to MongoOAuth2Authorization entity
- **`toDomain(MongoOAuth2Authorization, RegisteredClientRepository)`** - Converts MongoDB entity back to OAuth2Authorization domain object
- **PKCE Support** - Handles code_challenge and code_challenge_method parameters across different storage locations
- **Token Management** - Maps authorization codes, access tokens, and refresh tokens with metadata

## Usage Example

```java
// Converting to MongoDB entity for persistence
OAuth2Authorization authorization = // ... obtained from Spring Security
MongoOAuth2Authorization entity = MongoAuthorizationMapper.toEntity(authorization);
mongoRepository.save(entity);

// Converting back to domain object for use with Spring Security
MongoOAuth2Authorization storedEntity = mongoRepository.findById(authId);
RegisteredClientRepository clientRepo = // ... your client repository
OAuth2Authorization restored = MongoAuthorizationMapper.toDomain(storedEntity, clientRepo);

// The mapper preserves all OAuth2 flow data including:
// - Authorization requests with PKCE parameters
// - Token values and metadata
// - Principal information and scopes
```

The mapper handles the complexity of preserving PKCE parameters that may be stored in different locations (authorization request additional parameters vs token metadata) and ensures proper reconstruction of the complete OAuth2 authorization state.