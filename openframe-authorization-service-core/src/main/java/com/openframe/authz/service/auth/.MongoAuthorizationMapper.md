<!-- source-hash: 1d303b1cfb1b2bf6ce40ab7009eec6b6 -->
A utility mapper class that converts OAuth2 authorization objects between Spring Security's domain model and MongoDB entity representation, with special handling for PKCE (Proof Key for Code Exchange) parameters.

## Key Components

- **`toEntity(OAuth2Authorization auth)`** - Converts Spring Security OAuth2Authorization to MongoOAuth2Authorization entity
- **`toDomain(MongoOAuth2Authorization e, RegisteredClientRepository clients)`** - Converts MongoDB entity back to Spring Security OAuth2Authorization
- **PKCE Support** - Handles code challenge and verification method parameters across different storage formats
- **Token Management** - Maps authorization codes, access tokens, and refresh tokens with metadata
- **TTL Handling** - Sets appropriate expiration times for MongoDB document lifecycle

## Usage Example

```java
// Convert domain object to MongoDB entity for persistence
OAuth2Authorization authorization = // ... obtained from Spring Security
MongoOAuth2Authorization entity = MongoAuthorizationMapper.toEntity(authorization);
mongoRepository.save(entity);

// Convert MongoDB entity back to domain object for Spring Security
MongoOAuth2Authorization stored = mongoRepository.findById(authId);
OAuth2Authorization restored = MongoAuthorizationMapper.toDomain(stored, clientRepository);

// The mapper preserves PKCE parameters, token metadata, and authorization state
// across the persistence boundary, ensuring OAuth2 flows continue seamlessly
```

The mapper ensures OAuth2 authorization flows work correctly with MongoDB storage by preserving all necessary OAuth2 parameters, tokens, and metadata while handling the complexities of PKCE parameter normalization across different storage formats.