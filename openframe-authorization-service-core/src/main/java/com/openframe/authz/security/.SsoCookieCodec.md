<!-- source-hash: 23bd14c079498e6dd3e9fe45ff0371e2 -->
A Spring service that provides secure cookie encoding and decoding functionality for SSO operations, using HMAC-SHA256 signatures and Base64 encoding to ensure data integrity and prevent tampering.

## Key Components

- **encode()** - Generic method to encode any object into a signed cookie string
- **encodeTenant()** - Specialized encoder for tenant registration cookie payloads
- **encodeInvite()** - Specialized encoder for invitation cookie payloads
- **decode()** - Generic method to decode and validate signed cookies with expiration checking
- **decodeTenant()** - Specialized decoder for tenant registration cookies
- **decodeInvite()** - Specialized decoder for invitation cookies
- **sign()** - Creates HMAC-SHA256 signatures for cookie validation
- **constantTimeEquals()** - Timing-safe string comparison to prevent timing attacks

## Usage Example

```java
@Autowired
private SsoCookieCodec cookieCodec;

// Encode a tenant registration payload
SsoTenantRegCookiePayload tenantPayload = new SsoTenantRegCookiePayload(
    "tenant-123", 
    Instant.now().plusHours(1).getEpochSecond()
);
String encodedCookie = cookieCodec.encodeTenant(tenantPayload);

// Decode and validate the cookie
Optional<SsoTenantRegCookiePayload> decoded = cookieCodec.decodeTenant(encodedCookie);
if (decoded.isPresent()) {
    // Cookie is valid and not expired
    SsoTenantRegCookiePayload payload = decoded.get();
    // Process the payload...
}

// Similar usage for invitation cookies
SsoInviteCookiePayload invitePayload = new SsoInviteCookiePayload(/*...*/);
String inviteCookie = cookieCodec.encodeInvite(invitePayload);
Optional<SsoInviteCookiePayload> decodedInvite = cookieCodec.decodeInvite(inviteCookie);
```

The service automatically handles signature verification, expiration checking via reflection on the payload's `exp()` method, and provides secure timing-attack resistant validation.