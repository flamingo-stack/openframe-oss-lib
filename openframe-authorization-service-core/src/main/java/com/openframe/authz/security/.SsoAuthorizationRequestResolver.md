<!-- source-hash: a0d07fbb90bb59934df945182c79ca99 -->
A custom OAuth2 authorization request resolver that extracts pre-generated state parameters from signed cookies and injects them into outgoing authorization requests to SSO providers like Google or Microsoft.

## Key Components

- **SsoAuthorizationRequestResolver** - Main class implementing OAuth2AuthorizationRequestResolver
- **delegate** - DefaultOAuth2AuthorizationRequestResolver for standard OAuth2 flow handling
- **ssoCookieCodec** - Service for decoding signed SSO cookies
- **resolve()** methods - Override points for injecting custom state parameters
- **maybeInjectStateFromCookie()** - Core logic for state parameter injection
- **extractStateFromCookie()** - Cookie parsing and state extraction logic

## Usage Example

```java
@Configuration
public class SecurityConfig {
    
    @Bean
    public OAuth2AuthorizationRequestResolver ssoAuthorizationRequestResolver(
            ClientRegistrationRepository clientRegistrationRepository,
            SsoCookieCodec ssoCookieCodec) {
        
        return new SsoAuthorizationRequestResolver(
            clientRegistrationRepository, 
            ssoCookieCodec
        );
    }
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http,
                                         OAuth2AuthorizationRequestResolver resolver) throws Exception {
        return http
            .oauth2Login(oauth2 -> oauth2
                .authorizationEndpoint(auth -> auth
                    .authorizationRequestResolver(resolver)
                )
            )
            .build();
    }
}
```

The resolver reads state from either `COOKIE_SSO_REG` (tenant registration) or `COOKIE_SSO_INVITE` (invitation) cookies, decodes them using the codec, and injects the state into the OAuth2 authorization request for stateful SSO flows.