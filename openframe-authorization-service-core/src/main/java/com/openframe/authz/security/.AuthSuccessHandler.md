<!-- source-hash: c0faf7c342e7a427c8e1c75eb18dd8ff -->
Handles post-authentication success processing to update user login timestamps and manage email verification for OAuth2/OIDC flows while preserving existing SSO registration functionality.

## Key Components

- **onAuthenticationSuccess()** - Main handler that updates user's lastLogin timestamp and delegates to SSO handler
- **maybeMarkEmailVerifiedFromSso()** - Automatically marks email as verified for trusted OAuth2 providers (Google, Microsoft)
- **extractEmail()** - Extracts email from different authentication principal types (OidcUser, UserDetails, or fallback)

## Usage Example

```java
// Configured automatically as Spring component
@Configuration
public class SecurityConfig {
    
    @Autowired
    private AuthSuccessHandler authSuccessHandler;
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        return http
            .oauth2Login(oauth2 -> oauth2
                .successHandler(authSuccessHandler))
            .formLogin(form -> form
                .successHandler(authSuccessHandler))
            .build();
    }
}
```

The handler integrates with Spring Security's authentication flow to:
- Track user activity via lastLogin updates
- Automatically verify emails from trusted OAuth2 providers
- Maintain compatibility with existing SSO tenant registration flows
- Gracefully handle failures without blocking authentication