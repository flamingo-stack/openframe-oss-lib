<!-- source-hash: d6307cde98bebf21e2776bf15e85294d -->
A Spring Security authentication success handler that finalizes SSO tenant registration after successful OIDC authentication. It validates state parameters and delegates to appropriate flow handlers to complete tenant and user creation.

## Key Components

- **SsoTenantRegistrationSuccessHandler**: Main handler extending `SavedRequestAwareAuthenticationSuccessHandler`
- **flowHandlers**: List of `SsoFlowHandler` implementations for different SSO flows
- **ssoCookieCodec**: Service for encoding/decoding SSO-related cookies
- **onAuthenticationSuccess()**: Primary method that processes successful authentication
- **validateStateOrThrow()**: Security validation method ensuring state parameter integrity

## Usage Example

```java
// Automatically invoked by Spring Security after successful OIDC authentication
// Configuration in security config:
@Configuration
public class SecurityConfig {
    
    @Autowired
    private SsoTenantRegistrationSuccessHandler successHandler;
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        return http
            .oauth2Login(oauth2 -> oauth2
                .successHandler(successHandler)
            )
            .build();
    }
}

// The handler will:
// 1. Check for active SSO flow handlers
// 2. Validate OIDC state parameter against cookie
// 3. Complete tenant registration process
// 4. Handle errors gracefully with HTTP 400 response
```

The handler supports both tenant registration (`COOKIE_SSO_REG`) and invitation flows (`COOKIE_SSO_INVITE`), ensuring secure state validation before finalizing the SSO tenant setup process.