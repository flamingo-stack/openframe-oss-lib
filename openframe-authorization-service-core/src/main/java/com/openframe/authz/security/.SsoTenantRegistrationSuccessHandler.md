<!-- source-hash: d6307cde98bebf21e2776bf15e85294d -->
Handles successful OIDC authentication for SSO tenant registration flows by validating state parameters and delegating to appropriate flow handlers to complete tenant and user creation.

## Key Components

- **SsoTenantRegistrationSuccessHandler** - Main authentication success handler extending Spring Security's `SavedRequestAwareAuthenticationSuccessHandler`
- **flowHandlers** - List of `SsoFlowHandler` implementations for different SSO flows
- **ssoCookieCodec** - Service for encoding/decoding SSO cookies
- **onAuthenticationSuccess()** - Main method that processes successful OIDC authentication
- **validateStateOrThrow()** - Validates OAuth state parameter against cookie values

## Usage Example

```java
// Configuration in Spring Security
@Configuration
public class SecurityConfig {
    
    @Autowired
    private SsoTenantRegistrationSuccessHandler successHandler;
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        return http
            .oauth2Login(oauth2 -> oauth2
                .successHandler(successHandler)
            )
            .build();
    }
}

// Flow handler implementation
@Component
public class TenantRegistrationFlowHandler implements SsoFlowHandler {
    
    @Override
    public boolean isActivated(HttpServletRequest request) {
        return request.getCookies() != null && 
               Arrays.stream(request.getCookies())
                   .anyMatch(c -> c.getName().equals(COOKIE_SSO_REG));
    }
    
    @Override
    public void handle(HttpServletRequest request, 
                      HttpServletResponse response, 
                      Authentication auth) {
        // Complete tenant registration using OIDC user info
    }
}
```