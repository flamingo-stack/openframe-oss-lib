<!-- source-hash: ef3ef6b1f73e23e27cf5560ffb02d527 -->
A Spring WebFlux service that manages HTTP cookies for authentication, handling access tokens, refresh tokens, and OAuth state management with configurable security settings.

## Key Components

- **Token Cookie Management**: Creates and clears access token and refresh token cookies with configurable expiration times
- **OAuth State Cookies**: Manages short-lived JWT-signed state cookies for OAuth flows with format `of_oauth_{state}`
- **Session Cookie Cleanup**: Handles clearing of JSESSIONID and SSO-related cookies (`of_sso_reg`, `of_sso_invite`)
- **Cookie Extraction**: Retrieves access tokens from incoming requests via `ServerWebExchange`
- **Security Configuration**: Configurable domain, secure flag, and SameSite settings for cookie security

## Usage Example

```java
@RestController
public class AuthController {
    
    @Autowired
    private CookieService cookieService;
    
    @PostMapping("/login")
    public ResponseEntity<String> login(@RequestBody LoginRequest request) {
        // After successful authentication
        String accessToken = "jwt_access_token";
        String refreshToken = "jwt_refresh_token";
        
        HttpHeaders headers = new HttpHeaders();
        cookieService.addAuthCookies(headers, accessToken, refreshToken);
        
        return ResponseEntity.ok().headers(headers).body("Login successful");
    }
    
    @PostMapping("/logout")
    public ResponseEntity<String> logout() {
        HttpHeaders headers = new HttpHeaders();
        cookieService.addClearAuthCookies(headers);
        
        return ResponseEntity.ok().headers(headers).body("Logged out");
    }
    
    @GetMapping("/protected")
    public ResponseEntity<String> protectedEndpoint(ServerWebExchange exchange) {
        String accessToken = cookieService.getAccessTokenFromCookies(exchange);
        if (accessToken != null) {
            // Process authenticated request
            return ResponseEntity.ok("Access granted");
        }
        return ResponseEntity.status(401).body("Unauthorized");
    }
}
```