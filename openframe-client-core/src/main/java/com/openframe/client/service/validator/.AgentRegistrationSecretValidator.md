<!-- source-hash: 8801fa3d3ed51bd975e8c615c86f695a -->
A Spring component that validates agent registration secrets by comparing provided keys against encrypted secrets stored in the database.

## Key Components

- **`validate(String initialKey)`** - Main validation method that checks if the provided initial key matches the active agent registration secret
- **`AgentRegistrationSecretRepository`** - Repository dependency for accessing stored registration secrets
- **`EncryptionService`** - Service dependency for decrypting stored secret keys

## Usage Example

```java
@Autowired
private AgentRegistrationSecretValidator validator;

public void registerAgent(String providedKey) {
    try {
        // Validate the registration key before proceeding
        validator.validate(providedKey);
        
        // Key is valid - continue with agent registration
        processAgentRegistration();
        
    } catch (AgentRegistrationSecretValidationException e) {
        // Handle validation errors (empty or invalid key)
        log.error("Registration failed: {}", e.getMessage());
        throw new RegistrationException("Invalid registration key");
        
    } catch (AgentRegistrationSecretValidationErrorException e) {
        // Handle system errors (no active secret found)
        log.error("System error during validation: {}", e.getMessage());
        throw new SystemException("Registration system unavailable");
    }
}
```

The validator performs three key checks: ensures the initial key is not blank, retrieves the active registration secret from the database, and compares the decrypted secret with the provided key. It throws specific exceptions for different failure scenarios to enable proper error handling and user feedback.