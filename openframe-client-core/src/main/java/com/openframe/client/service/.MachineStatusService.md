<!-- source-hash: 7ee312bb66007bb3c0b5be8213e70b92 -->
A Spring service that manages machine status updates with timestamp-based event ordering to prevent stale updates from overriding newer status changes.

## Key Components

- **updateToOnline()** - Updates machine status to online with timestamp
- **updateToOffline()** - Updates machine status to offline with timestamp  
- **processHeartbeat()** - Processes heartbeat events by setting status to online
- **update()** - Core method that validates events and applies status changes
- **isEventNewer()** - Prevents stale events from overriding newer status updates
- **applyStatusUpdate()** - Persists status and timestamp changes to the database

## Usage Example

```java
@Autowired
private MachineStatusService machineStatusService;

// Update machine to online status
machineStatusService.updateToOnline("machine-123", Instant.now());

// Process heartbeat to maintain online status
machineStatusService.processHeartbeat("machine-123", Instant.now());

// Update machine to offline status
machineStatusService.updateToOffline("machine-123", Instant.now());

// Stale events are automatically ignored
Instant oldTimestamp = Instant.now().minusSeconds(3600);
machineStatusService.updateToOnline("machine-123", oldTimestamp); // Will be ignored
```

The service ensures data consistency by comparing event timestamps against the machine's last seen timestamp, preventing out-of-order events from corrupting the current status. All operations are logged for monitoring and debugging purposes.