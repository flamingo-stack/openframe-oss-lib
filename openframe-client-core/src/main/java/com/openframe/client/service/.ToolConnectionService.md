<!-- source-hash: b36b4baf19b5a67a0ae7f73e794479c6 -->
Manages tool connections between OpenFrame agents and external tools, handling connection status tracking and persistence. This service provides transactional operations for adding, updating, and validating tool connections with proper status management.

## Key Components

- **addToolConnection()** - Main entry point for establishing tool connections with validation and status management
- **processExistingToolConnection()** - Handles updates to existing connections, including status changes and agent ID updates
- **addNewToolConnection()** - Creates new tool connection records with initial CONNECTED status
- **Validation methods** - validateAgentId(), validateToolType(), validateMachineExists() for input validation
- **Dependencies** - ToolConnectionRepository, MachineRepository, ToolAgentIdTransformerService

## Usage Example

```java
@Autowired
private ToolConnectionService toolConnectionService;

// Add a new tool connection
toolConnectionService.addToolConnection(
    "agent-123", 
    "DATABASE", 
    "db-tool-456", 
    true
);

// The service will:
// 1. Validate the agent ID and tool type
// 2. Check if machine exists
// 3. Either update existing connection or create new one
// 4. Set appropriate connection status and timestamps
// 5. Transform agent tool ID based on tool type
```

The service automatically handles connection state transitions from DISCONNECTED to CONNECTED, updates agent tool IDs when they change, and maintains audit timestamps for connection tracking. All operations are transactional to ensure data consistency.