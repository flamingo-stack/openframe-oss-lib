<!-- source-hash: c9e4a5820d0e9ac9749a06013212c218 -->
This service handles the registration of new agents in the OpenFrame system, creating OAuth clients and machine records with proper organization assignment.

## Key Components

- **`register()`** - Main registration method that validates initial key, generates machine credentials, and orchestrates the complete registration process
- **`saveOAuthClient()`** - Creates OAuth client with client credentials grant type and agent role
- **`saveMachine()`** - Persists machine information with device status, type, and organization assignment
- **`resolveOrganizationId()`** - Determines the appropriate organization ID, falling back to default if requested organization doesn't exist
- **`getDefaultOrganizationId()`** - Retrieves the default organization for fallback scenarios

## Usage Example

```java
@Autowired
private AgentRegistrationService agentRegistrationService;

// Create registration request
AgentRegistrationRequest request = new AgentRegistrationRequest();
request.setHostname("agent-server-01");
request.setIp("192.168.1.100");
request.setMacAddress("00:1B:44:11:3A:B7");
request.setOsType("Linux");
request.setAgentVersion("1.2.0");
request.setOrganizationId("org-123"); // Optional

// Register the agent
AgentRegistrationResponse response = agentRegistrationService.register(
    "initial-secret-key", 
    request
);

// Use the generated credentials
String machineId = response.getMachineId();
String clientId = response.getClientId();
String clientSecret = response.getClientSecret();
```