flowchart TD
    TokenRequest["Token Encoding"] --> JwkSource["JWKSource"]
    JwkSource --> TenantId["TenantContext.getTenantId()"]
    TenantId --> KeyService["TenantKeyService"]
    KeyService --> Repo["TenantKeyRepository (Mongo)"]
    KeyService --> Encoder["NimbusJwtEncoder"]
