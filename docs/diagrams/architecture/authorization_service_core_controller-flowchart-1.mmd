flowchart TD
    subgraph Controllers
        IRC["InvitationRegistrationController"]
        LC["LoginController"]
        PRC["PasswordResetController"]
        SDC["SsoDiscoveryController"]
        TDC["TenantDiscoveryController"]
        TRC["TenantRegistrationController"]
    end
    
    IRC -->|uses| DTO["authorization_service_core_dto"]
    LC -->|uses| DTO
    PRC -->|uses| DTO
    SDC -->|uses| DTO
    TDC -->|uses| DTO
    TRC -->|uses| DTO
    
    IRC -->|calls| ServiceAuth["authorization_service_core_service_auth"]
    LC -->|calls| ServiceAuth
    PRC -->|calls| ServiceAuth
    SDC -->|calls| ServiceAuth
    TDC -->|calls| ServiceAuth
    TRC -->|calls| ServiceAuth
    
    SDC -->|uses| Security["authorization_service_core_security"]
    TRC -->|uses| Security
    SDC -->|uses| SecurityFlow["authorization_service_core_security_flow"]
    TRC -->|uses| SecurityFlow
    
    TRC -->|uses| Keys["authorization_service_core_keys"]
    
    ServiceAuth -->|persists| Repository["authorization_service_core_repository"]
    ServiceAuth -->|uses| Policy["authorization_service_core_service_policy"]
    ServiceAuth -->|uses| Processor["authorization_service_core_service_processor"]
    ServiceAuth -->|uses| SsoService["authorization_service_core_service_sso"]
    
    SecurityFlow -->|invokes| Processor
    Security -->|uses| Keys