flowchart TD
    subgraph config_layer["Configuration Layer"]
        AppConfig["ApiApplicationConfig"]
        SecConfig["SecurityConfig"]
        AuthConfig["AuthenticationConfig"]
        ScalarConfig["DateScalarConfig & InstantScalarConfig"]
        DataInit["DataInitializer"]
    end

    subgraph rest_layer["REST Controllers"]
        UserCtrl["UserController"]
        OrgCtrl["OrganizationController"]
        ApiKeyCtrl["ApiKeyController"]
        SsoCtrl["SSOConfigController"]
        ForceCtrl["ForceAgentController"]
        InviteCtrl["InvitationController"]
    end

    subgraph graphql_layer["GraphQL Layer"]
        DeviceFetcher["DeviceDataFetcher"]
        EventFetcher["EventDataFetcher"]
        LogFetcher["LogDataFetcher"]
        OrgFetcher["OrganizationDataFetcher"]
        ToolFetcher["ToolsDataFetcher"]
    end

    subgraph service_layer["Service Layer"]
        UserSvc["UserService"]
        SsoSvc["SSOConfigService"]
        DomainValidator["DefaultDomainExistenceValidator"]
    end

    subgraph dataloader_layer["DataLoaders"]
        OrgLoader["OrganizationDataLoader"]
        TagLoader["TagDataLoader"]
        AgentLoader["InstalledAgentDataLoader"]
        ToolConnLoader["ToolConnectionDataLoader"]
    end

    rest_layer --> service_layer
    graphql_layer --> service_layer
    graphql_layer --> dataloader_layer
    service_layer --> MongoLayer["Mongo Repositories"]
