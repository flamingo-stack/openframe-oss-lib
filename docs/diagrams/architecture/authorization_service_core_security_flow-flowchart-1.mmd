flowchart TD
    User["User"] -->|initiates SSO| LoginController["LoginController"]
    LoginController -->|delegates| InviteSsoHandler["InviteSsoHandler"]
    LoginController -->|delegates| TenantRegSsoHandler["TenantRegSsoHandler"]
    InviteSsoHandler -->|validates invitation| SsoRegistrationConstants["SsoRegistrationConstants"]
    InviteSsoHandler -->|fetches keys| TenantKeyService["TenantKeyService"]
    InviteSsoHandler -->|registers client| MongoAuthorizationService["MongoAuthorizationService"]
    TenantRegSsoHandler -->|validates registration| SsoTenantRegistrationSuccessHandler["SsoTenantRegistrationSuccessHandler"]
    TenantRegSsoHandler -->|manages keys| TenantKeyService
    TenantRegSsoHandler -->|registers client| MongoAuthorizationService
    TenantRegSsoHandler -->|persists tenant| TenantRepository["TenantRepository"]
    MongoAuthorizationService -->|stores client| MongoRegisteredClientRepository["MongoRegisteredClientRepository"]
    TenantKeyService -->|generates keys| RsaAuthenticationKeyPairGenerator["RsaAuthenticationKeyPairGenerator"]