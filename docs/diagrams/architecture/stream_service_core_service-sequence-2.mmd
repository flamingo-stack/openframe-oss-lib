sequenceDiagram
    participant K as "Kafka Topic"
    participant L as "JsonKafkaListener"
    participant D as "Deserializer"
    participant M as "EventTypeMapper"
    participant H as "MessageHandler"
    participant E as "EnrichmentService"
    participant O as "Output Stream"

    K->>L: Consume raw event
    L->>D: Deserialize event
    D->>M: Map event type/source
    M->>H: Handle mapped event
    H->>E: Enrich event data
    E->>O: Output enriched event