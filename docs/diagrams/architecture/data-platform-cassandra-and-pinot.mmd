flowchart LR
    subgraph operational_layer["Operational Layer"]
        Mongo["Mongo Repositories"]
        MachineRepo["MachineRepository"]
        TagRepo["TagRepository"]
    end

    subgraph data_platform["Data Platform Cassandra And Pinot"]
        Aspect["MachineTagEventAspect"]
        EventService["MachineTagEventServiceImpl"]
        KafkaProducer["OssTenantRetryingKafkaProducer"]
        CassandraCfg["CassandraConfig"]
        PinotCfg["PinotConfig"]
        DeviceRepo["PinotClientDeviceRepository"]
        LogRepo["PinotClientLogRepository"]
    end

    subgraph streaming_layer["Streaming Layer"]
        Kafka["Kafka"]
        StreamCore["Stream Processing Core"]
    end

    subgraph analytics_layer["Analytics Layer"]
        Pinot["Apache Pinot"]
    end

    Mongo --> MachineRepo
    Mongo --> TagRepo

    MachineRepo --> Aspect
    TagRepo --> Aspect

    Aspect --> EventService
    EventService --> KafkaProducer
    KafkaProducer --> Kafka

    Kafka --> StreamCore
    StreamCore --> Pinot

    PinotCfg --> DeviceRepo
    PinotCfg --> LogRepo
    DeviceRepo --> Pinot
    LogRepo --> Pinot

    CassandraCfg --> Cassandra["Apache Cassandra"]
