<!-- source-hash: ebcff04caa561e342e1d5b43b2dafd4a -->
Service for managing agent registration secrets used to authenticate and authorize new agent registrations. Handles secret generation, retrieval, encryption/decryption, and lifecycle management with single active secret enforcement.

## Key Components

- **`getActiveSecret()`** - Retrieves the currently active registration secret, decrypting it for use
- **`getAllSecrets()`** - Returns all registration secrets (active and inactive) with decrypted keys
- **`generateNewSecret()`** - Creates a new registration secret, deactivates existing ones, and stores encrypted version
- **`deactivateExisting()`** - Private method to deactivate the current active secret before generating new one

## Usage Example

```java
@Autowired
private AgentRegistrationSecretService secretService;

// Get the current active secret for agent registration
AgentRegistrationSecretResponse activeSecret = secretService.getActiveSecret();
String secretKey = activeSecret.getKey();

// Generate a new secret (automatically deactivates old one)
AgentRegistrationSecretResponse newSecret = secretService.generateNewSecret();
log.info("New secret generated: {}", newSecret.getId());

// Retrieve all secrets for audit purposes
List<AgentRegistrationSecretResponse> allSecrets = secretService.getAllSecrets();
```

The service ensures only one secret is active at a time and automatically handles encryption/decryption of stored secrets for security.