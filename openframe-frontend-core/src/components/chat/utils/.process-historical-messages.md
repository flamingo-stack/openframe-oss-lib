<!-- source-hash: 7e09c2236a5e011ba67fbc791276c8dc -->
Utility for converting raw historical messages from GraphQL/API responses into structured, display-ready format for chat interfaces. Handles message grouping, approval workflows, tool executions, and error processing.

## Key Components

### Main Functions
- **`processHistoricalMessages()`** - Primary function that converts historical messages into display format
- **`processHistoricalMessagesWithErrors()`** - Enhanced version that includes error messages in correct chronological order
- **`extractErrorMessages()`** - Extracts and formats error messages separately
- **`processMessageData()`** - Processes individual message data items into segments

### Types
- **`ProcessHistoricalMessagesResult`** - Return type containing processed messages and escalated approvals map
- **`MessageProcessingOptions`** - Configuration options for message processing behavior

### Message Processing Features
- Groups consecutive assistant messages into single display units
- Handles approval request/result pairing and escalation
- Processes tool execution states (executing/executed)
- Filters messages by chat type when specified
- Manages approval status tracking and display permissions

## Usage Example

```typescript
import { processHistoricalMessages } from './process-historical-messages'

// Basic usage
const result = processHistoricalMessages(rawMessages, {
  assistantName: 'Fae',
  assistantType: 'fae',
  chatTypeFilter: 'support'
})

// With approval handling
const resultWithApprovals = processHistoricalMessages(rawMessages, {
  assistantName: 'Mingo',
  onApprove: (requestId) => handleApproval(requestId, true),
  onReject: (requestId) => handleApproval(requestId, false),
  approvalStatuses: { 'req-123': 'approved' },
  displayApprovalTypes: ['CLIENT', 'ADMIN']
})

console.log(result.messages) // Array of ProcessedMessage objects
console.log(result.escalatedApprovals) // Map of escalated approval requests
```