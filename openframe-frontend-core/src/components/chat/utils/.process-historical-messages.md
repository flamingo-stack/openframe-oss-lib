<!-- source-hash: 16438ee71e3146bb969f4ad46a52dedd -->
A utility module that transforms raw historical messages from GraphQL/API responses into a structured format optimized for chat display components. It handles message aggregation, approval workflows, tool executions, and error processing.

## Key Components

### Main Functions
- **`processHistoricalMessages()`** - Core function that processes historical messages into display-ready format
- **`extractErrorMessages()`** - Extracts and formats error messages separately
- **`processHistoricalMessagesWithErrors()`** - Processes messages while preserving error message order
- **`processMessageData()`** - Internal helper that processes individual message data items

### Types
- **`ProcessHistoricalMessagesResult`** - Return type containing processed messages and escalated approvals
- **`MessageProcessingOptions`** - Configuration options for message processing

## Usage Example

```typescript
import { processHistoricalMessages, extractErrorMessages } from './process-historical-messages'

// Process historical messages for chat display
const result = processHistoricalMessages(historicalMessages, {
  assistantName: 'Fae',
  assistantType: 'fae',
  chatTypeFilter: 'support',
  approvalStatuses: { 'req-123': 'approved' },
  displayApprovalTypes: ['CLIENT', 'ADMIN'],
  onApprove: (requestId) => handleApproval(requestId, true),
  onReject: (requestId) => handleApproval(requestId, false)
})

// Access processed messages and escalated approvals
const { messages, escalatedApprovals } = result

// Extract error messages separately if needed
const errorMessages = extractErrorMessages(historicalMessages, {
  assistantName: 'Fae',
  chatTypeFilter: 'support'
})
```

The module aggregates consecutive assistant messages, handles various message types (text, tool executions, approvals, errors), and maintains proper message ordering for chat interfaces.