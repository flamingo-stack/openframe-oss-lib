<!-- source-hash: 12ea0efee30014ce3cd912e7e45766da -->
A Spring service that publishes tool agent updates to NATS messaging system with configurable publishing control and publish state management.

## Key Components

- **publish()** - Main method that publishes tool agent updates to NATS topics with feature flag validation
- **markAsNonPublished()** / **markAsPublished()** - State management methods that track publishing status of tool agents
- **buildTopicName()** - Generates dynamic NATS topic names using pattern `machine.all.tool.{toolId}.update`
- **buildMessage()** - Creates `ToolAgentUpdateMessage` with tool metadata and download configurations
- **Feature flag support** - Controlled by `openframe.tool-agent.update.feature.enabled` property
- **Conditional loading** - Only active when `spring.cloud.stream.enabled` is true

## Usage Example

```java
@Autowired
private ToolAgentUpdateUpdatePublisher publisher;

// Publish a tool agent update
IntegratedToolAgent toolAgent = // ... get tool agent
publisher.publish(toolAgent);

// The service will:
// 1. Check if publishing is enabled via feature flag
// 2. Mark tool as non-published state
// 3. Build topic name: "machine.all.tool.my-tool-id.update"
// 4. Create message with tool ID, version, session type, and download configs
// 5. Publish persistently to NATS
// 6. Mark tool as published state
// 7. Log the successful publication
```

The publisher ensures reliable delivery through persistent NATS publishing and maintains audit trails via publish state tracking, making it suitable for distributed tool agent deployment scenarios.